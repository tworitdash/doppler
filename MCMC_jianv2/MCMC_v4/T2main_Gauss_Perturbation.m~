clear;

Nu = 10000;
Mu = pi; 
% Sigma = 0.5 * 4 * pi / 0.03 * 1e-3;
Sigma = 0.3;
U_ = normrnd(Mu, Sigma, [1 Nu]);

Psi_ = -pi + 2 * pi * rand([1 Nu]);
% Psi_ = 0 .* rand([1 Nu]);

[Psim, Psin] = meshgrid(Psi_, Psi_);

[U1, U2] = meshgrid(U_, U_);

Np = 128;
Ng = 0;
Ns = 2;
K_ = [];

for i = 1:Ns
    K_ = [K_ (i-1)*(Np + Ng):(i-1)*(Np+Ng)+Np-1];
end

Nt = length(K_);

for ki = 1:Nt
    k = K_(ki);
    x(k) = sum( exp(1j .* U_ .* k + 1j .* Psi_) );
end

SNR_db = 30;

SNR = 10^(input_info.SNR/10);

Noise = sum(abs(x).^2)./(Nt .* SNR);         % Finding Noise power and ...
                                             %noise variance with the data and given SNR
sigma_n = sqrt(Noise);

z = x + sigma_n/sqrt(2) .* (randn(1, Nt) + 1j .* randn(1, Nt)); % Adding complex noise 


u = linspace(0, 2 * pi, Nt);

figure; plot(u, abs(fft()))
